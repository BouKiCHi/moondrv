
# PCMTOOL説明書

## ■説明

PCMTOOLは、wavファイルやパラメータを指定したテキストファイルからPCMファイルを作成するツールです。

## ■使用方法

データの作成は、Windows等のコンソール上で、

```
PCMTOOL (PCM定義テキスト)
```

と入力します。（ファイル名は任意）


データの読み出しは、MSX上のDOSで、
```
>PCMLOAD (PCMファイル)
```
と入力します。

データの読み出しには、MDRファイルにパッキングを行う方法もあります。


## ■PCM定義テキスト詳細

PCM定義テキストは、以下の項目を連続で並べた物です。

```
file.wav bit loop end
lfo vib ar d1r dl d2r rc rr am
```

* file.wav

WAVファイルを指定します。内部フォーマットによっては読めない場合もあります。その場合には別のソフトウェアで変換を行ってください。

* bit
生成されるデータのビット長で、指定できる数値は以下の通りです。

| 0    | 1     | 2     |
| ---- | ----- | ----- |
| 8bit | 12bit | 16bit |


* loop/end

これらの数値は「指定サンプル数-1」です。-1の場合は最後のサンプル数になります。loopさせない場合は-1を指定します。

* lfoなど

レジスタにある数値と同じです。これらのパラメータは基本的にはMML側で設定可能ですので、0で埋めてください。

## ■定義例

```
piano_11k_c4.wav 1 -1 -1
0 0 0 0 0 0 0 0 0
```

| 項目     | 内容  |
| -------- | ----- |
| ビット長 | 12bit |
| loop     | 終端  |
| end      | 終端  |

## ■MMLでの利用

　MoonDriverのMMLからPCMへアクセスするには、@TONEの音色番号を$180(= 10進数で384)以降
にすることで音色を利用することができます。

MMLでは次のようになります。

```
@TONE0 = {
 $00, $7f, $0180, 6000,  $20, $f2, $13, $0f, $00
}
```

@TONEの詳細はMoonDriverの説明を参照してください。

## ■実際のサンプリング周波数とピッチ補正値（参考）

　ピッチ補正値は、MML上の定義の4番目の数値になります。


| サンプリング周波数 | o4c時の値 |
| ------------------ | --------- |
| 11KHz              | 3000      |
| 16KHz              | 4000      |
| 22KHz              | 4500      |
| 44KHz              | 6000      |